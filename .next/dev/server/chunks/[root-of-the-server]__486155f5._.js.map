{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///D:/Testing/AstroWeb-7ae30bc1f7a1605f38f538a70a5f77df29722c38/shared/schema.ts"],"sourcesContent":["import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, decimal, boolean, timestamp } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Products Schema\nexport const products = pgTable(\"products\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  category: text(\"category\").notNull(), // Gemstones, Bracelets, Rudraksha, Yantras, Rings, Remedies\n  price: decimal(\"price\", { precision: 10, scale: 2 }).notNull(),\n  description: text(\"description\").notNull(),\n  images: text(\"images\").array().notNull(),\n  benefits: text(\"benefits\").array().notNull(),\n  certified: boolean(\"certified\").default(true),\n  inStock: boolean(\"in_stock\").default(true),\n  rating: decimal(\"rating\", { precision: 3, scale: 2 }).default(\"4.50\"),\n  reviewCount: integer(\"review_count\").default(0),\n});\n\nexport const insertProductSchema = createInsertSchema(products).omit({\n  id: true,\n});\n\nexport type Product = typeof products.$inferSelect;\nexport type InsertProduct = z.infer<typeof insertProductSchema>;\n\n// Blog Posts Schema\nexport const blogPosts = pgTable(\"blog_posts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: text(\"title\").notNull(),\n  slug: text(\"slug\").notNull().unique(),\n  excerpt: text(\"excerpt\").notNull(),\n  content: text(\"content\").notNull(),\n  category: text(\"category\").notNull(), // Astrology, Gemstones, Spirituality, Wellness\n  featuredImage: text(\"featured_image\").notNull(),\n  author: text(\"author\").notNull(),\n  readTime: integer(\"read_time\").notNull(), // in minutes\n  metaDescription: text(\"meta_description\").notNull(),\n  publishedAt: timestamp(\"published_at\").notNull(),\n});\n\nexport const insertBlogPostSchema = createInsertSchema(blogPosts).omit({\n  id: true,\n});\n\nexport type BlogPost = typeof blogPosts.$inferSelect;\nexport type InsertBlogPost = z.infer<typeof insertBlogPostSchema>;\n\n// Appointments Schema\nexport const appointments = pgTable(\"appointments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  email: text(\"email\").notNull(),\n  phone: text(\"phone\").notNull(),\n  date: text(\"date\").notNull(),\n  time: text(\"time\").notNull(),\n  consultationType: text(\"consultation_type\").notNull(), // Personal, Business, Relationship, Health\n  message: text(\"message\"),\n  status: text(\"status\").default(\"pending\"), // pending, accepted, declined, completed\n  paymentStatus: text(\"payment_status\").default(\"pending\"), // pending, completed, failed\n  razorpayOrderId: text(\"razorpay_order_id\"),\n  razorpayPaymentId: text(\"razorpay_payment_id\"),\n  createdAt: timestamp(\"created_at\").default(sql`now()`),\n});\n\nexport const insertAppointmentSchema = createInsertSchema(appointments).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type Appointment = typeof appointments.$inferSelect;\nexport type InsertAppointment = z.infer<typeof insertAppointmentSchema>;\n\n// Testimonials Schema\nexport const testimonials = pgTable(\"testimonials\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  location: text(\"location\").notNull(),\n  rating: integer(\"rating\").notNull(),\n  review: text(\"review\").notNull(),\n  avatar: text(\"avatar\").notNull(),\n  verified: boolean(\"verified\").default(true),\n});\n\nexport const insertTestimonialSchema = createInsertSchema(testimonials).omit({\n  id: true,\n});\n\nexport type Testimonial = typeof testimonials.$inferSelect;\nexport type InsertTestimonial = z.infer<typeof insertTestimonialSchema>;\n\n// Cart Schema (stored in-memory, not persisted)\nexport interface CartItem {\n  productId: string;\n  name: string;\n  price: number;\n  quantity: number;\n  image: string;\n}\n\nexport interface Cart {\n  items: CartItem[];\n  total: number;\n}\n\n// Contact Form Schema\nexport interface ContactFormData {\n  name: string;\n  email: string;\n  phone: string;\n  subject: string;\n  message: string;\n}\n\nexport const contactFormSchema = z.object({\n  name: z.string().min(2, \"Name must be at least 2 characters\"),\n  email: z.string().email(\"Invalid email address\"),\n  phone: z.string().min(10, \"Phone must be at least 10 digits\"),\n  subject: z.string().min(5, \"Subject must be at least 5 characters\"),\n  message: z.string().min(10, \"Message must be at least 10 characters\"),\n});\n\n// Videos Schema\nexport const videos = pgTable(\"videos\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: text(\"title\").notNull(),\n  youtubeUrl: text(\"youtube_url\").notNull(),\n  thumbnailUrl: text(\"thumbnail_url\").notNull(),\n  createdAt: timestamp(\"created_at\").default(sql`now()`),\n});\n\nexport const insertVideoSchema = createInsertSchema(videos).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type Video = typeof videos.$inferSelect;\nexport type InsertVideo = z.infer<typeof insertVideoSchema>;\n\n// Order Schema\nexport const orders = pgTable(\"orders\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  customerName: text(\"customer_name\").notNull(),\n  customerEmail: text(\"customer_email\").notNull(),\n  customerPhone: text(\"customer_phone\").notNull(),\n  shippingAddress: text(\"shipping_address\").notNull(),\n  items: text(\"items\").notNull(), // JSON stringified cart items\n  totalAmount: decimal(\"total_amount\", { precision: 10, scale: 2 }).notNull(),\n  paymentStatus: text(\"payment_status\").default(\"pending\"),\n  razorpayOrderId: text(\"razorpay_order_id\"),\n  razorpayPaymentId: text(\"razorpay_payment_id\"),\n  createdAt: timestamp(\"created_at\").default(sql`now()`),\n});\n\nexport const insertOrderSchema = createInsertSchema(orders).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type Order = typeof orders.$inferSelect;\nexport type InsertOrder = z.infer<typeof insertOrderSchema>;\n\n// Users Schema (for storing user profiles and admin status)\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey(),\n  email: text(\"email\").notNull().unique(),\n  fullName: text(\"full_name\"),\n  isAdmin: boolean(\"is_admin\").default(false),\n  accountType: text(\"account_type\").default(\"customer\"), // 'admin' or 'customer'\n  createdAt: timestamp(\"created_at\").default(sql`now()`),\n  updatedAt: timestamp(\"updated_at\").default(sql`now()`),\n});\n\nexport type User = typeof users.$inferSelect;\n\n// Zodiac Signs\nexport interface ZodiacSign {\n  name: string;\n  slug: string;\n  symbol: string;\n  element: string;\n  dates: string;\n  traits: string[];\n  compatibility: string[];\n  luckyStone: string;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 226, "column": 0}, "map": {"version":3,"sources":["file:///D:/Testing/AstroWeb-7ae30bc1f7a1605f38f538a70a5f77df29722c38/src/pages/api/users.ts"],"sourcesContent":["import { NextApiRequest, NextApiResponse } from \"next\";\r\nimport { db } from \"@/lib/db\";\r\nimport { users } from \"@shared/schema\";\r\nimport { eq } from \"drizzle-orm\";\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n    if (req.method === \"POST\") {\r\n        const { id, email, fullName, isAdmin, accountType } = req.body;\r\n\r\n        if (!id || !email) {\r\n            return res.status(400).json({ error: \"Missing required fields\" });\r\n        }\r\n\r\n        try {\r\n            // Upsert user profile\r\n            const [user] = await db.insert(users)\r\n                .values({\r\n                    id,\r\n                    email,\r\n                    fullName,\r\n                    isAdmin: !!isAdmin,\r\n                    accountType: accountType || \"customer\",\r\n                    updatedAt: new Date()\r\n                })\r\n                .onConflictDoUpdate({\r\n                    target: users.id,\r\n                    set: {\r\n                        email,\r\n                        fullName,\r\n                        isAdmin: !!isAdmin,\r\n                        accountType: accountType || \"customer\",\r\n                        updatedAt: new Date()\r\n                    }\r\n                })\r\n                .returning();\r\n\r\n            return res.status(200).json(user);\r\n        } catch (error) {\r\n            console.error(\"Error syncing user profile:\", error);\r\n            return res.status(500).json({ error: \"Failed to sync user profile\" });\r\n        }\r\n    }\r\n\r\n    return res.status(405).json({ error: \"Method not allowed\" });\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;AAEA;;;;;;;AAGe,eAAe,QAAQ,GAAmB,EAAE,GAAoB;IAC3E,IAAI,IAAI,MAAM,KAAK,QAAQ;QACvB,MAAM,EAAE,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,WAAW,EAAE,GAAG,IAAI,IAAI;QAE9D,IAAI,CAAC,MAAM,CAAC,OAAO;YACf,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAA0B;QACnE;QAEA,IAAI;YACA,sBAAsB;YACtB,MAAM,CAAC,KAAK,GAAG,MAAM,GAAG,MAAM,CAAC,qLAAK,EAC/B,MAAM,CAAC;gBACJ;gBACA;gBACA;gBACA,SAAS,CAAC,CAAC;gBACX,aAAa,eAAe;gBAC5B,WAAW,IAAI;YACnB,GACC,kBAAkB,CAAC;gBAChB,QAAQ,qLAAK,CAAC,EAAE;gBAChB,KAAK;oBACD;oBACA;oBACA,SAAS,CAAC,CAAC;oBACX,aAAa,eAAe;oBAC5B,WAAW,IAAI;gBACnB;YACJ,GACC,SAAS;YAEd,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAChC,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,+BAA+B;YAC7C,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAA8B;QACvE;IACJ;IAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,OAAO;IAAqB;AAC9D"}}]
}
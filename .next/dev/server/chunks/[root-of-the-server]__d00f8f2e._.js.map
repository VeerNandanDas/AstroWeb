{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///D:/Testing/AstroWeb-7ae30bc1f7a1605f38f538a70a5f77df29722c38/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || \"https://your-project.supabase.co\";\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || \"your-anon-key\";\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\n\nexport async function getAuthToken() {\n  try {\n    const { data: { session } } = await supabase.auth.getSession();\n    return session?.access_token || null;\n  } catch (error) {\n    console.error(\"Error getting auth token:\", error);\n    return null;\n  }\n}\n\nexport async function signUp(email: string, password: string) {\n  return await supabase.auth.signUp({ email, password });\n}\n\nexport async function signIn(email: string, password: string) {\n  return await supabase.auth.signInWithPassword({ email, password });\n}\n\nexport async function signOut() {\n  return await supabase.auth.signOut();\n}\n\nexport async function getCurrentUser() {\n  const { data: { user } } = await supabase.auth.getUser();\n  return user;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;AAEA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,kBAAkB,wPAA6C;AAE9D,MAAM,WAAW,IAAA,iKAAY,EAAC,aAAa;AAE3C,eAAe;IACpB,IAAI;QACF,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;QAC5D,OAAO,SAAS,gBAAgB;IAClC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO;IACT;AACF;AAEO,eAAe,OAAO,KAAa,EAAE,QAAgB;IAC1D,OAAO,MAAM,SAAS,IAAI,CAAC,MAAM,CAAC;QAAE;QAAO;IAAS;AACtD;AAEO,eAAe,OAAO,KAAa,EAAE,QAAgB;IAC1D,OAAO,MAAM,SAAS,IAAI,CAAC,kBAAkB,CAAC;QAAE;QAAO;IAAS;AAClE;AAEO,eAAe;IACpB,OAAO,MAAM,SAAS,IAAI,CAAC,OAAO;AACpC;AAEO,eAAe;IACpB,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IACtD,OAAO;AACT"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///D:/Testing/AstroWeb-7ae30bc1f7a1605f38f538a70a5f77df29722c38/src/pages/api/appointments.ts"],"sourcesContent":["import { NextApiRequest, NextApiResponse } from \"next\";\nimport { supabase } from \"@/lib/supabase\";\n\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\n    if (req.method === \"GET\") {\n        // Get all appointments (admin only through auth check in frontend)\n        try {\n            const { data: appointments, error } = await supabase\n                .from(\"appointments\")\n                .select(\"*\")\n                .order(\"created_at\", { ascending: false });\n\n            if (error) {\n                console.error(\"Error fetching appointments:\", error);\n                return res.status(500).json({ error: \"Failed to fetch appointments\" });\n            }\n\n            // Transform snake_case to camelCase for frontend\n            const formattedAppointments = appointments.map(apt => ({\n                id: apt.id,\n                name: apt.name,\n                email: apt.email,\n                phone: apt.phone,\n                date: apt.date,\n                time: apt.time,\n                consultationType: apt.consultation_type,\n                message: apt.message,\n                status: apt.status,\n                paymentStatus: apt.payment_status,\n                razorpayOrderId: apt.razorpay_order_id,\n                razorpayPaymentId: apt.razorpay_payment_id,\n                createdAt: apt.created_at\n            }));\n\n            return res.status(200).json(formattedAppointments);\n        } catch (error) {\n            console.error(\"Error in GET /api/appointments:\", error);\n            return res.status(500).json({ error: \"Internal server error\" });\n        }\n    }\n\n    if (req.method === \"POST\") {\n        // Create a new appointment\n        try {\n            const { name, email, phone, date, time, consultationType, message } = req.body;\n\n            // Validate required fields\n            if (!name || !email || !phone || !date || !time || !consultationType) {\n                return res.status(400).json({ error: \"Missing required fields\" });\n            }\n\n            // Insert appointment into database\n            const { data, error } = await supabase\n                .from(\"appointments\")\n                .insert([\n                    {\n                        name,\n                        email,\n                        phone,\n                        date,\n                        time,\n                        consultation_type: consultationType,\n                        message: message || null,\n                        status: \"pending\",\n                        payment_status: \"pending\"\n                    }\n                ])\n                .select()\n                .single();\n\n            if (error) {\n                console.error(\"Error creating appointment:\", error);\n                return res.status(500).json({ error: error.message || \"Failed to create appointment\" });\n            }\n\n            return res.status(201).json({\n                id: data.id,\n                name: data.name,\n                email: data.email,\n                phone: data.phone,\n                date: data.date,\n                time: data.time,\n                consultationType: data.consultation_type,\n                message: data.message,\n                status: data.status,\n                createdAt: data.created_at\n            });\n        } catch (error: any) {\n            console.error(\"Error in POST /api/appointments:\", error);\n            return res.status(500).json({ error: error.message || \"Internal server error\" });\n        }\n    }\n\n    return res.status(405).json({ error: \"Method not allowed\" });\n}\n"],"names":[],"mappings":";;;;AACA;;AAEe,eAAe,QAAQ,GAAmB,EAAE,GAAoB;IAC3E,IAAI,IAAI,MAAM,KAAK,OAAO;QACtB,mEAAmE;QACnE,IAAI;YACA,MAAM,EAAE,MAAM,YAAY,EAAE,KAAK,EAAE,GAAG,MAAM,8LAAQ,CAC/C,IAAI,CAAC,gBACL,MAAM,CAAC,KACP,KAAK,CAAC,cAAc;gBAAE,WAAW;YAAM;YAE5C,IAAI,OAAO;gBACP,QAAQ,KAAK,CAAC,gCAAgC;gBAC9C,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;oBAAE,OAAO;gBAA+B;YACxE;YAEA,iDAAiD;YACjD,MAAM,wBAAwB,aAAa,GAAG,CAAC,CAAA,MAAO,CAAC;oBACnD,IAAI,IAAI,EAAE;oBACV,MAAM,IAAI,IAAI;oBACd,OAAO,IAAI,KAAK;oBAChB,OAAO,IAAI,KAAK;oBAChB,MAAM,IAAI,IAAI;oBACd,MAAM,IAAI,IAAI;oBACd,kBAAkB,IAAI,iBAAiB;oBACvC,SAAS,IAAI,OAAO;oBACpB,QAAQ,IAAI,MAAM;oBAClB,eAAe,IAAI,cAAc;oBACjC,iBAAiB,IAAI,iBAAiB;oBACtC,mBAAmB,IAAI,mBAAmB;oBAC1C,WAAW,IAAI,UAAU;gBAC7B,CAAC;YAED,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAChC,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,mCAAmC;YACjD,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAwB;QACjE;IACJ;IAEA,IAAI,IAAI,MAAM,KAAK,QAAQ;QACvB,2BAA2B;QAC3B,IAAI;YACA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,gBAAgB,EAAE,OAAO,EAAE,GAAG,IAAI,IAAI;YAE9E,2BAA2B;YAC3B,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,kBAAkB;gBAClE,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;oBAAE,OAAO;gBAA0B;YACnE;YAEA,mCAAmC;YACnC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,8LAAQ,CACjC,IAAI,CAAC,gBACL,MAAM,CAAC;gBACJ;oBACI;oBACA;oBACA;oBACA;oBACA;oBACA,mBAAmB;oBACnB,SAAS,WAAW;oBACpB,QAAQ;oBACR,gBAAgB;gBACpB;aACH,EACA,MAAM,GACN,MAAM;YAEX,IAAI,OAAO;gBACP,QAAQ,KAAK,CAAC,+BAA+B;gBAC7C,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;oBAAE,OAAO,MAAM,OAAO,IAAI;gBAA+B;YACzF;YAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBACxB,IAAI,KAAK,EAAE;gBACX,MAAM,KAAK,IAAI;gBACf,OAAO,KAAK,KAAK;gBACjB,OAAO,KAAK,KAAK;gBACjB,MAAM,KAAK,IAAI;gBACf,MAAM,KAAK,IAAI;gBACf,kBAAkB,KAAK,iBAAiB;gBACxC,SAAS,KAAK,OAAO;gBACrB,QAAQ,KAAK,MAAM;gBACnB,WAAW,KAAK,UAAU;YAC9B;QACJ,EAAE,OAAO,OAAY;YACjB,QAAQ,KAAK,CAAC,oCAAoC;YAClD,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO,MAAM,OAAO,IAAI;YAAwB;QAClF;IACJ;IAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,OAAO;IAAqB;AAC9D"}}]
}